## Duration Gameplay Effect 

### 1. Instant Gameplay Effect å›é¡¾

- C++ å®ç°ï¼š
  - è·å–ç›®æ ‡çš„ **AbilitySystemComponent (ASC)**
  - åˆ›å»º **EffectContext**
  - æ·»åŠ  **SourceObject** (ä»… C++ å¯è°ƒç”¨ï¼ŒBlueprint æ— æ³•ç›´æ¥è°ƒç”¨)
  - åˆ›å»º **Outgoing Spec**
  - è°ƒç”¨ `ApplyGameplayEffectSpecToSelf` åº”ç”¨æ•ˆæœ
- Blueprint å®ç°ï¼š
  - `GetAbilitySystemComponent(Actor)`
  - `MakeEffectContext`
  - `MakeOutgoingSpec` (ä¼ å…¥ GameplayEffectClass, Level, Context)
  - `ApplyGameplayEffectSpecToSelf`
  - é€»è¾‘æ›´ç®€æ´ï¼Œä½†åŠŸèƒ½ä¸å¦‚ C++ å…¨é¢

------

### 2. Blueprint çš„å±€é™

- æŸäº›å‡½æ•°ï¼ˆå¦‚ `AddSourceObject`ã€`GetSourceObject`ï¼‰**é BlueprintCallable**
- éœ€è¦é€šè¿‡ **AbilitySystemBlueprintLibrary** é‡Œçš„é™æ€å‡½æ•°é—´æ¥è®¿é—®
- å¯ä»¥è‡ªå»º **Blueprint Function Library** æ¥æš´éœ²æ›´å¤š C++ åŠŸèƒ½ç»™ Blueprint

------

### 3. ä¸ºä»€ä¹ˆç”¨ C++ï¼Ÿ

- Blueprint è™½ç„¶æ›´ç®€æ´ï¼Œä½†èŠ‚ç‚¹ä¼šå †ç§¯ â†’ éš¾ä»¥ç®¡ç†
- C++ å¯ä»¥ï¼š
  - æš´éœ²è‡ªå®šä¹‰èŠ‚ç‚¹
  - æä¾›æ›´å®Œæ•´çš„ API
  - ä¿æŒ Blueprint é¢æ¿å¹²å‡€ï¼Œåªç•™ä¸€ä¸ªå‡½æ•°è°ƒç”¨

------

### 4. Gameplay Effect Duration Policy

GameplayEffect æœ‰ä¸‰ç§æŒç»­æ—¶é—´ç±»å‹ï¼š

1. **Instant** â†’ ç«‹åˆ»ç”Ÿæ•ˆï¼Œç«‹åˆ»ç»“æŸ
2. **Has Duration** â†’ æœ‰æ—¶é•¿ï¼Œè‡ªåŠ¨åˆ°æœŸå¤±æ•ˆ
3. **Infinite** â†’ ä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°æ‰‹åŠ¨ç§»é™¤

------

### 5. ç¤ºä¾‹ï¼šCrystal Heal (Has Duration)

- æ–°å»º `G_CrystalHeal` GameplayEffect
- è®¾ç½® **Duration Policy = Has Duration**
- Duration Magnitude = **2 ç§’**
- ä¿®æ”¹ MaxHealthï¼š+100
- æ•ˆæœï¼š
  - åŸæœ¬ MaxHealth = 100 â†’ ä¸´æ—¶å˜æˆ 200 (æŒç»­ 2 ç§’)
  - å½“å‰ Health ä¸å˜ â†’ çœ‹èµ·æ¥è¡€æ¡ç™¾åˆ†æ¯”ä¸‹é™
  - 2 ç§’åæ¢å¤åŸçŠ¶

------

### 6. Blueprint åº”ç”¨ Duration Effect

- æ–°å»º Blueprintï¼š`BP_HealthCrystal` (ç»§æ‰¿ AuraEffectActor)
- è®¾ç½® `DurationGameplayEffectClass = CrystalHeal`
- OnOverlap â†’ `ApplyEffectToTarget`
- ä¼ å…¥ **OtherActor** + **DurationEffect**
- æœ€å `DestroyActor`

------

### 7. æµ‹è¯•æ•ˆæœ

- æ‹¾å–æ°´æ™¶ â†’ MaxHealth å˜æˆ 200 â†’ è¡€æ¡ä¸‹é™
- 2 ç§’å â†’ è‡ªåŠ¨æ¢å¤åˆ° 100
- ä¸éœ€è¦é¢å¤– Timerï¼ŒGE ç³»ç»Ÿè‡ªåŠ¨ç®¡ç†æ—¶æ•ˆ

------

ğŸ‘‰ ç»“è®ºï¼š

- **Instant é€‚åˆä¸€æ¬¡æ€§æ•ˆæœ**ï¼ˆå¦‚å›è¡€ã€åŠ è“ï¼‰
- **Has Duration é€‚åˆ Buff/Debuff**ï¼ˆä¸´æ—¶åŠ é€Ÿã€åŠ è¡€ä¸Šé™ï¼‰
- Blueprint ç®€å•å¿«é€Ÿï¼Œä½†å—é™ â†’ **æ¨èå¤æ‚é€»è¾‘å†™åœ¨ C++ï¼ŒBlueprint åªè´Ÿè´£è°ƒç”¨**

Â·