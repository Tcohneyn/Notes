这段视频字幕详细讲解了如何通过虚幻引擎（Unreal Engine）的**黑板（Blackboard）**和 **C++ 行为树服务（BT Service）**来实现 AI 寻找并追踪最近玩家的逻辑。

以下是全部内容的标题大纲式详细总结：

------

### 一、 核心概念：黑板（Blackboard）的作用

- **变量存储中心**：行为树本身和行为树服务（Service）都不直接存储持久化变量。所有的状态数据（如目标、距离等）都存储在“黑板”资产中。
- **黑板隐喻**：黑板就像教室里的黑板，由 AI 控制器写入信息，行为树根据这些信息决定执行路径。
- **默认键（Key）**：每个黑板默认包含一个 `Self Actor` 键，通常指向受该行为树控制的 Character 本身。

### 二、 黑板键选择器（Blackboard Key Selector）

- **连接桥梁**：在蓝图或 C++ 中，通过创建 `BlackboardKeySelector` 类型的变量，可以将代码逻辑与黑板上的特定键（Key）关联起来。
- **细节面板公开**：将该变量设为“可编辑（Edit Anywhere）”，即可在行为树编辑器的服务节点详情面板中通过下拉菜单选择对应的黑板键。
- **读取值**：演示了如何使用 `Get Blackboard Value as Object` 获取黑板中存储的对象并打印其名称。

### 三、 设计追踪逻辑所需的黑板键

- **创建新键**：
  1. **TargetToFollow**（类型：Object/Actor）：存储 AI 需要追踪的目标对象。将基类设为 `Actor` 以获得更多操作权限。
  2. **DistanceToTarget**（类型：Float）：存储 AI 与目标之间的当前距离。
- **实例同步（Instance Synced）说明**：
  - **勾选**：所有共享该黑板的 AI 实例将同步该变量值（一变全变）。
  - **不勾选（默认）**：每个 AI 实例拥有独立的变量副本，互不干扰。

### 四、 C++ 开发：创建黑板关联变量

- **头文件配置**：
  - 引入 `FBlackboardKeySelector` 结构体。
  - 定义 `TargetToFollowSelector` 和 `DistanceToTargetSelector`。
  - 使用 `UPROPERTY(EditAnywhere)` 宏将其公开，以便在编辑器中进行链接。

### 五、 目标识别机制：Actor 标签（Actor Tags）

- **标签 vs 转型（Casting）**：相比于昂贵的类型转换，使用 Actor 标签是分类和识别 Actor 更简单、高效的方法。
- **设置标签**：
  - 在 `EnemyBase` 蓝图中添加 "Enemy" 标签。
  - 在 `Aura`（玩家）蓝图中添加 "Player" 标签。
- **多用途性**：这套逻辑也适用于友方 AI（如宠物），宠物可以根据标签寻找敌人，而敌人则寻找玩家。

### 六、 C++ 实现：获取所有潜在目标

- **逻辑判定**：
  - 使用三元运算符根据自身标签判定要搜索的目标标签（如果我是敌人，搜索 "Player"；如果我是玩家，搜索 "Enemy"）。
- **API 调用**：
  - 引入 `Kismet/GameplayStatics.h`。
  - 使用 `UGameplayStatics::GetAllActorsWithTag` 函数。
- **数据准备**：将场景中所有带目标标签的 Actor 存入一个数组（`TArray<AActor*>`），为下一步计算最近距离做准备。

------

**下节预告**：视频最后提出，既然已经获取了所有潜在目标的数组，接下来的任务是编写算法遍历该数组，计算并找出离当前 AI 最近的那个 Actor。