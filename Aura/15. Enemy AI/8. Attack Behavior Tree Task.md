这段视频教程详细介绍了如何在虚幻引擎（Unreal Engine）中结合 C++ 和蓝图（Blueprint）创建一个自定义的行为树任务（BT Task），并以此实现近战与远程敌人不同的攻击行为。

以下是内容的标题大纲式详细总结：

### 一、 自定义行为树任务的需求

- **内置任务的局限性**：虽然虚幻提供了 `MoveTo` 和 `Wait` 等常用任务，但特定动作（如“攻击”）需要自定义逻辑。
- **C++ 与蓝图的结合**：为了兼顾性能和灵活性，创建一个 C++ 基类，并在其基础上派生蓝图类来实现具体功能。

### 二、 创建 C++ 任务基类

- **父类选择**：选择 `BTTask_BlueprintBase` 作为父类，这使得任务既能在 C++ 中编写核心逻辑，也能在蓝图里重写事件。
- **核心函数重写**：
  - **`ExecuteTask`**：这是任务的入口点。
  - **调用 `Super::ExecuteTask`**：这一点至关重要，因为它负责触发蓝图中的 `Receive Execute AI` 事件。
- **C++ 优势**：即使目前逻辑简单，保留 C++ 基类也为未来处理高计算量任务（如复杂算法）预留了空间。

### 三、 在蓝图中实现攻击任务

- **创建蓝图类**：基于自定义的 `BTTask_Attack` 创建名为 `BT_Attack` 的蓝图。
- **实现 `Receive Execute AI` 事件**：
  - 获取控制的 **Pawn** 和 **Controller** 信息。
  - **必须调用 `Finish Execute` 节点**：任务完成后必须返回“成功”或“失败”，否则行为树会一直卡在该节点。
- **可视化调试**：使用 `Draw Debug Sphere`（绘制调试球体）在 AI 攻击时提供视觉反馈，确认逻辑触发正确。

### 四、 行为树逻辑优化：近战与远程差异化

- **距离控制**：
  - 使用装饰器（Decorator）检查 AI 与玩家的距离。
  - **中止逻辑（Abort Self）**：设置接近分支在距离小于 500 单位时中止，使 AI 停在玩家附近。
- **近战 AI 行为链**：
  1. **接近（Approach）**：先跑到距离玩家 500 单位处。
  2. **靠近（Get Close）**：执行一个新的 `MoveTo`，将“接受半径（Acceptance Radius）”设为 20。
  3. **执行攻击（Attack）**：到达极近距离后触发攻击任务。
- **远程 AI 行为**：通过黑板值判定，使其保持在远处而不进入“靠近”逻辑。

### 五、 运行效果与后续改进

- **测试观察**：
  - 近战敌人（如持矛哥布林）会冲到玩家面前并产生红色调试球。
  - 远程敌人会留在后方观察。
- **导航网格说明**：当前 AI 使用基本的 **NavMesh** 寻路，暂未加入复杂的避障逻辑（AI 之间可能会互相推挤或重叠）。
- **下一步计划**：将攻击任务与 **Gameplay Ability System (GAS)** 结合，实现真正的伤害输出和动画播放。

------

**您想了解如何将这个攻击任务与特定的蒙太奇动画（Animation Montage）关联起来，还是想深入研究 C++ 中 `ExecuteTask` 的更多底层细节？**