这段视频教程介绍了如何将配置好的 **EQS（环境查询系统）** 集成到 AI **行为树（Behavior Tree）** 中，让远程攻击者能够智能地寻找射击位置并执行攻击逻辑。

以下是内容的标题大纲式详细总结：

### 一、 行为树中的 EQS 集成

- **添加 `Run EQS Query` 节点**：在远程攻击者的行为序列（Sequence）中添加该任务。
- **配置查询请求 (EQS Request)**：
  - **Query Template**：选择之前创建的 `EQ_FindRangedAttackPosition`。
  - **Blackboard Key**：将查询到的最佳位置存储到黑板键 `MoveToLocation` 中。
- **重命名节点以增加清晰度**：将节点命名为 `Calculate Fire Position`（计算射击位置）。

### 二、 远程攻击行为序列构建

为了实现完整的逻辑循环，教程构建了以下节点顺序：

1. **Calculate Fire Position (EQS)**：计算出既能看到玩家又离 AI 最近的位置。
2. **Move To**：移动到黑板上的 `MoveToLocation`。
3. **Attack (BT_Attack)**：执行攻击任务（目前表现为生成红色调试球）。
4. **Wait**：等待 1 秒（带 0.5 秒随机偏差），防止攻击过于频繁。

### 三、 C++ 代码崩溃修复 (Bug Fix)

在测试过程中遇到了数组越界导致的崩溃：

- **问题原因**：AI 在移动或寻找路径时，代码尝试访问 `PathPoints` 数组，但在路径无效时该数组为空。

- **修复方法**：在 `AuraPlayerController` 中增加判空检查：

  C++

  ```
  if (NavPath.PathPoints.Num() > 0) { // 仅在有点时访问路径点 }
  ```

- **工程操作**：清理 `Intermediate` 和 `Binaries` 文件夹并重新编译，确保修复生效。

### 四、 实战测试与障碍物处理

- **修正攻击节点**：确保使用的是蓝图版的 `BT_Attack` 而非空的 C++ 基类节点。
- **障碍物表现测试**：
  - 在场景中放置墙壁并确认其阻挡 **Visibility（可见性）** 频道。
  - **AI 表现**：当玩家躲在墙后时，AI 不再原地踏步，而是会自动绕过墙角，一旦获得对玩家的视野（Line of Sight）便立即停止并开始射击。
- **点击移动的冲突考虑**：
  - 讨论了墙壁碰撞设置对“点击移动（Click to Move）”的影响。如果墙壁阻挡了可见性频道，可能会影响玩家的操作体验，建议后续为 AI 探测和玩家点击设置独立的碰撞频道。

### 五、 核心效果与下一步预告

- **当前成果**：
  - **近战 AI**：靠近玩家并绕行攻击。
  - **远程 AI**：利用 EQS 寻找视野开阔的位置并保持距离攻击。
- **下一步计划**：目前攻击仅显示红色调试球，接下来将实现真正的战斗系统，包括造成伤害和实际的技能释放逻辑。

------

**您想了解如何为 AI 设置独立的碰撞频道来优化视野检测，还是想直接开始编写处理伤害的 `BT_Attack` 逻辑？**