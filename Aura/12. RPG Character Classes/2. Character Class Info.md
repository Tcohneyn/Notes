# **角色类数据资产系统实现（Character Class Info）

—— 大纲式技术总结**

## **1. 创建角色类数据资产（Character Class Info Data Asset）**

### 1.1 目的

用于存储所有 RPG 角色类（Elementalist / Warrior / Ranger）对应的初始化数据，包括：

- 属性初始化用的 Gameplay Effect
- 各类共享/独立的属性初始化逻辑
- 不同角色类的默认配置集合

### 1.2 实现步骤

- 创建 C++ 类：继承自 **UDataAsset**
- 路径：`Aura/Public/AbilitySystem/Data`
- 命名：`CharacterClassInfo`

------

## **2. 创建角色类枚举（ECharacterClass）**

### 2.1 枚举要求

- 使用 **enum class** + `uint8`
- 添加 `UENUM(BlueprintType)` 以便在蓝图可见

### 2.2 角色类定义

- **Elementalist**（魔法系）
- **Warrior**（战士，近战）
- **Ranger**（远程攻击）

------

## **3. 定义角色类默认信息结构体（FCharacterClassDefaultInfo）**

### 3.1 基本结构

- 创建 `USTRUCT(BlueprintType)`
- 包含角色初始化所需全部数据（Gameplay Effects、默认属性等）

### 3.2 结构体内字段

#### ✔ 每个类独有：

- **Primary Attributes GameplayEffect**
  - 指定敌人/角色初始一级（主属性）来源

#### ✔ 所有角色类共享（Common Defaults）：

- **Secondary Attributes GameplayEffect**
- **Vital Attributes GameplayEffect**

（共享设计可减少重复，也可扩展为每类独立版本，系统灵活）

------

## **4. 使用 TMap 建立 “角色类 → 默认信息” 的映射**

### 4.1 数据资产内字段

```cpp
TMap<ECharacterClass, FCharacterClassDefaultInfo> CharacterClassInformation;
```

### 4.2 优点

- 可直接通过枚举查询
- 保证每类配置独立、可扩展
- 方便蓝图编辑（支持 EditDefaultsOnly）

------

## **5. 添加查找函数（GetClassDefaultInfo）**

### 5.1 用途

根据枚举值快速获取对应类的默认初始化数据。

### 5.2 实现

```cpp
FCharacterClassDefaultInfo UCharacterClassInfo::GetClassDefaultInfo(ECharacterClass Class)
{
    return CharacterClassInformation.FindChecked(Class);
}
```

- 使用 `FindChecked` 确保错误时直接断言，避免无效配置导致运行时异常。

------

## **6. 在编辑器中创建 Data Asset 并填充字段**

### 6.1 创建数据资产

路径：Blueprints / AbilitySystem / Data
 操作：

- Miscellaneous → Data Asset
- 选择 `CharacterClassInfo`

### 6.2 填充角色类配置

- 注意：TMap 默认已生成 `Elementalist` 键，添加其它键需要先修改键值类型
- 最终填入：
  - Elementalist
  - Warrior
  - Ranger

### 6.3 编辑字段

- 设置各类 PrimaryAttribute Gameplay Effect
- 设置共享的 Secondary / Vital Gameplay Effect

------

## **7. 下一步：创建对应的 Gameplay Effects**

本段结尾指出：

- Primary、Secondary、Vital 各类属性初始化用的 **Gameplay Effects** 需要在下一段内容中继续创建。

------

# **总结重点（极简版）**

1. 创建 CharacterClassInfo（DataAsset） → 存全角色类的数据。
2. 创建 ECharacterClass（蓝图可见枚举）。
3. 定义 FCharacterClassDefaultInfo（包含 Primary/Secondary/Vital GE）。
4. 用 TMap 建立枚举 → 数据结构映射。
5. 提供 GetClassDefaultInfo 供初始化系统调用。
6. 在编辑器创建 DataAsset 并填充 Elementalist/Warrior/Ranger 的属性初始化数据。

