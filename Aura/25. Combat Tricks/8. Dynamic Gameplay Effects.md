这段视频详细讲解了如何在 C++ 中动态创建并应用 **Gameplay Effect (GE)**，以实现减益效果（Debuff，如燃烧），并处理了角色死亡后的逻辑漏洞。

以下是内容的详细大纲总结：

### 一、 在 C++ 中动态创建 Gameplay Effect

通常 GE 是在蓝图中创建的，但为了实现高度动态的减益系统，导师演示了如何在代码中实时生成 GE：

- **创建 Context**：通过 `SourceASC->MakeEffectContext()` 创建效果上下文，并添加源对象（Source Object）。
- **实例化 GE 对象**：使用 `NewObject<UGameplayEffect>` 结合 `GetTransientPackage()` 在内存中动态创建一个 GE 实例。
- **动态命名**：利用 `FString::Printf` 根据伤害类型（如 Fire）为 GE 命名，便于调试。

### 二、 配置 GE 的核心持续逻辑

在 C++ 中设置对应蓝图面板里的各项参数：

- **持续时间策略**：将 `DurationPolicy` 设置为 `EGameplayEffectDurationType::HasDuration`。
- **周期 (Period)**：设置 `Period` 变量为 Debuff 的触发频率（如每 1 秒触发一次）。
- **时长幅度 (Duration Magnitude)**：使用 `FScalableFloat` 初始化 GE 的持续时长。

### 三、 添加属性修改器 (Modifiers)

为了让 Debuff 产生实际伤害，需要手动向 GE 添加修改器：

- **添加 Modifier**：向 GE 的 `Modifiers` 数组中添加一个 `FGameplayModifierInfo`。
- **配置参数**：
  - **幅度 (Magnitude)**：设置为通过 Library 获取的 Debuff 伤害数值。
  - **操作类型 (Op)**：设置为 `EGameplayModOp::Additive`（加法）。
  - **目标属性**：指定修改 `IncomingDamage`（传入伤害）这个元属性。

### 四、 赋予标签与堆叠设置

- **授予标签 (Granted Tags)**：通过 `InheritableOwnedTagsContainer.AddTag()`，让受影响的角色在 Debuff 期间获得特定的状态标签（如 `Debuff.Fire`）。这能让 AI 或 UI 识别当前状态。

注意InheritableOwnedTagsContainer已在5.3后淘汰这里使用FGameplayEffectSpec的DynamicGrantedTags来AddTag。

- **堆叠策略**：设置 `StackingType`（如按来源聚合）和 `StackLimitCount`（通常设为 1，防止同种 Debuff 无限堆叠）。

### 五、 创建 Spec 并应用效果

- **生成 Spec**：使用 `new FGameplayEffectSpec` 将动态创建的 GE、Context 和等级（Level 1）包装起来。
- **设置自定义数据**：在 Spec 的 Context 中存入伤害类型标签，以便后续处理逻辑识别。
- **应用效果**：通过 `TargetASC->ApplyGameplayEffectSpecToSelf(*MutableSpec)` 将效果施加给目标。

### 六、 优化：死亡状态检查 (IsDead Check)

在测试中发现，角色死亡后残余的 Debuff 仍会触发伤害和受击动作，为此进行了修复：

- **接口判定**：利用 `ICombatInterface` 的 `IsDead()` 函数。
- **逻辑拦截**：在属性集的 `PostGameplayEffectExecute` 开头增加判定——如果 **目标角色 (Target Character)** 已死亡，直接 `return` 拦截后续所有效果处理。
- **防止无限循环**：强调了在创建动态 Debuff 时，不应再次赋予“触发 Debuff 的概率”，否则可能导致 Debuff 触发 Debuff 的无限递归。

### 七、 总结与展望

- **当前成果**：成功实现了火球术 100% 触发燃烧效果，敌人会周期性扣血。
- **下一步计划**：目前只有数值变化，缺乏视觉反馈。后续将引入火粒子特效，让被“点燃”的敌人看起来真的在着火。

------

**提示**：在 C++ 中手动构建 GE 虽然代码量较多（需要手动设置所有下拉框对应的变量），但它提供了极大的灵活性，特别是在处理复杂的动态数值计算时。