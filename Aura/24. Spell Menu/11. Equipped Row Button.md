本视频教程主要讲解了如何为技能菜单底部的“已装备技能行”创建专用的按钮控件，并实现其根据玩家当前装备的技能动态更新图标的功能。

以下是详细的标题大纲式总结：

### 1. 专用控件的创建与差异化设计

- **需求分析**：技能树中的图标用于升级和加点，而底部的已装备栏图标用于选择按键槽位，功能不同，因此需要独立的控件 。

  

- **创建新控件**：复制现有的 `SpellGlobeButton`，重命名为 `WB_EquippedRowButton` 。

  

- **替换与布局**：

  - 在 `EquippedSpellRow` 中删除旧按钮，拖入新的 `EquippedRowButton` 。

    

  - **尺寸调整**：主动技能按钮统一设置为 60x60，Padding 为 4 。被动技能按钮设置为 40x40 。

    

### 2. 控件控制器 (Widget Controller) 的设置与传递

- **控制器切换**：在 `EquippedRowButton` 内部，将原本获取的 `OverlayWidgetController` 替换为 `SpellMenuWidgetController` 。

  

- **级联设置逻辑**：

  - `SpellMenu` 设置自身的控制器后，会调用 `EquippedSpellRow` 的 `SetWidgetController` 。

    

  - `EquippedSpellRow` 收到控制器后，通过自定义函数 `SetWidgetControllers`，遍历并设置所有子按钮（Globe_LMB, Globe_1 等）的控制器 。

    

  - 确保所有子控件在 `BroadcastInitialValues` 之前都已初始化 。

    

### 3. 数据监听与图标更新逻辑

- **监听委托**：子按钮绑定控制器的 `AbilityInfoDelegate`，监听技能信息的广播 。

  

- **Input Tag 匹配机制**：

  - 技能树关注 `Ability Tag`，而已装备行关注 `Input Tag`（输入标签） 。

    

  - 为 `EquippedRowButton` 添加可编辑变量 `InputTag` 。

    

  - 在编辑器中为每个槽位手动指定对应的标签（如 LMB, RMB, 1, 2, 3, 4） 。

    

- **更新视觉效果**：

  - 当广播的技能信息中的 `InputTag` 与按钮自身的标签完全匹配时 ，更新图标和背景材质 。

    

  - 将此逻辑封装为函数 `ReceiveAbilityInfo` 。

    

### 4. 默认空状态处理 (Clear State)

- **初始状态**：已装备栏默认为空，不应显示“锁定”图标 。

  

- **清理逻辑**：

  - 在 `PreConstruct` 中调用 `ClearGlobe` 。

    

  - 使用 `MakeSlateBrush` 创建透明笔刷（Transparent Brush），并调用 `SetBrush` 将图标和背景设置为不可见 。

    

  - 只有在接收到有效的技能绑定后，才会显示具体图标。

### 5. 被动技能标签 (Passive Input Tags) 的补充

- **缺失问题**：系统中缺少用于被动技能槽位的 Gameplay Tags 。

  

- **C++ 实现**：

  - 在 `AuraGameplayTags` 类中添加 `InputTag_Passive_1` 和 `InputTag_Passive_2` 。

    

  - 注册标签名称为 `InputTag.Passive.1` 和 `InputTag.Passive.2` 。

    

- **应用**：编译后在编辑器中将这两个新标签分配给对应的被动技能槽位 。

  

### 6. 功能验证与微调

- **广播测试**：在 `SpellMenuWidgetController` 中调用基类的 `BroadcastAbilityInfo` 。

  

- **运行测试**：运行游戏并打开技能菜单，确认只有已绑定的技能（如 Firebolt）显示在对应的槽位中，其他槽位为空 。

  

- **UI 微调**：将 Equip 按钮的高度调整为 60，与 Spend Point 按钮保持一致 。

  

  