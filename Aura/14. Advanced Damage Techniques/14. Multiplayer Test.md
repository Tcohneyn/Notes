这份视频字幕详细记录了在多人游戏环境下测试和调试 **Gameplay Ability System (GAS)** 项目的过程。视频重点解决了由于单机与联机机制差异导致的崩溃、逻辑错误及表现层 Bug。

以下是全部内容的详细标题大纲式总结：

------

### 一、 多人模式测试环境搭建与初探

- **测试必要性**：单机代码运行正常并不代表多人模式正常，联机测试是发现潜在崩溃（Crashes）和同步 Bug 的关键。
- **编辑器设置**：
  - 运行 Net Mode 选择 **Listen Server（监听服务器）**。
  - 增加玩家数量至 2 人或以上。
  - **关键点**：必须在 **Debug Mode（调试模式）** 下运行以便定位报错。

------

### 二、 解决第一个崩溃：GameMode 的权限访问限制

- **崩溃现象**：客户端玩家生成时产生异常，调用堆栈指向 `CharacterClassInfo` 为空。
- **原因分析**：
  - 代码尝试通过 `GetGameMode` 获取类信息。
  - **核心规则**：在虚幻引擎中，**GameMode 仅存在于服务器端**。客户端调用 `GetGameMode` 会返回空指针。
- **修复方案**：
  - 在 `AuraEnemy` 的 `BeginPlay` 中增加 `HasAuthority()` 权限检查，确保仅服务器赋予初始技能。
  - 在初始化默认属性时，同样增加权限检查，避免客户端尝试访问服务器独有的资源。

------

### 三、 修复伤害飘字（Floating Text）的 RPC 逻辑

- **Bug 表现**：客户端造成伤害时，飘字数字仅在服务器屏幕显示，客户端自己看不见。
- **逻辑纠错**：
  - 原代码使用 `GetPlayerController(0)`，在监听服务器上这始终返回服务器主机的控制器。
  - **改进方法**：从伤害来源（Source Character）动态获取其对应的 PlayerController。
  - **RPC 过滤**：在 `ShowDamageNumber` 的 Client RPC 实现中，增加 `IsLocalController()` 检查，确保伤害数字仅在发动攻击的本地客户端显示，避免服务器或其他玩家看到不属于自己的数字。

------

### 四、 投射物（Projectile）的联机同步与容错处理

- **空指针保护**：修复了在专有服务器上由于投射物过快销毁导致的循环音效组件（Looping Sound Component）空指针异常。
- **防止“自撞”逻辑**：
  - **Bug**：投射物在服务器上生成时可能会立即撞到发动者（Self）并销毁。
  - **修复**：在碰撞回调中提取 `EffectContext`，对比 `EffectCauser`。如果碰撞目标是发动者本身，则直接返回（Return Early），不触发爆炸和销毁。
- **投射物轨迹偏差**：
  - **问题**：由于客户端与服务器位置同步存在微小延迟，原本重置 Pitch 旋转的逻辑导致火球容易从敌人头顶飞过。
  - **修复**：取消对旋转 Pitch 的强制清零，允许投射物保留朝向目标的俯仰角，提高命中率。
- **音效重复触发（Double Sound）**：
  - **Bug**：客户端可能会同时收到多次销毁和碰撞回调，导致冲击音效重叠。
  - **修复**：利用 `bHit` 布尔标志位，确保冲击特效和音效仅执行一次。

------

### 五、 多人模式验证与系统扩展展望

- **测试结果**：通过 **Dedicated Server（专有服务器）** 和 **Listen Server** 模式验证，飘字、音效、伤害同步均恢复正常。
- **PvP 意外发现**：由于使用了通用的伤害检查，玩家之间目前可以互相伤害（尽管项目暂不侧重 PvP）。
- **后续路线规划**：
  - **技能系统升级**：实现技能菜单、输入重映射、技能等级提升及强化。
  - **角色成长系统**：经验值计算、等级提升 HUD 更新、属性点分配。
  - **AI 强化**：下一阶段将重点开发 **AI 行为树**，让敌人能够自动寻路并使用 GAS 技能反击玩家。