# 创建 AuraUserWidget 与 AuraWidgetController

## 1. 引入与准备工作

1.1 课程目标：为 UI 系统准备必要的基础类
 1.2 进入 `C++ Classes/Aura/Public` 路径，新建 C++ 类

## 2. 创建 AuraUserWidget 基类

2.1 新建 C++ 类，搜索并选择 **UserWidget** 作为父类
 2.2 命名为 **AuraUserWidget**，放置在 `UI/Widget` 文件夹中（保持命名规范：单数形式）
 2.3 作用：作为所有用户 Widget 的基类，确保兼容与共享功能

## 3. 创建 AuraWidgetController 类

3.1 新建 C++ 类，父类选择 **UObject**
 3.2 命名为 **AuraWidgetController**，放置在 `UI/WidgetController` 文件夹中
 3.3 作用：作为所有 Widget 的控制器基类，用于管理数据交互

## 4. 建立 Widget 与 Controller 的依赖关系

4.1 **依赖方向**：

- Widget → Controller（Widget 知道 Controller）
- Controller 不直接依赖具体 Widget
   4.2 在 AuraUserWidget 中添加成员变量：
- 类型：`TObjectPtr<UObject>`
- 名称：`WidgetController`
- 属性：`BlueprintReadOnly`，供蓝图访问但不可直接修改

## 5. WidgetControllerSet 初始化流程

5.1 在 AuraUserWidget 中新增函数：

- `SetWidgetController(UObject* InWidgetController)`
- 用于设置控制器并触发初始化逻辑
   5.2 新增 **蓝图可实现事件** `WidgetControllerSet`：
- 当控制器被设置时，触发初始化视觉逻辑
- 蓝图可根据需要实现对应 UI 行为

## 6. WidgetController 的核心职责

6.1 获取与广播游戏数据（作为 MVC 的中间层）：

- 来源包括 AbilitySystemComponent、AttributeSet、PlayerState、PlayerController
   6.2 在类中声明这四个指针变量：
- `TObjectPtr<APlayerController> PlayerController`
- `TObjectPtr<APlayerState> PlayerState`
- `TObjectPtr<UAbilitySystemComponent> AbilitySystemComponent`
- `TObjectPtr<UAttributeSet> AttributeSet`
   6.3 变量均设为 `BlueprintReadOnly`，类别为 `WidgetController`
   6.4 作用：统一存储并广播数据给绑定的 Widgets

## 7. 编译与验证

7.1 目前仅创建类与变量，尚未实例化
 7.2 编译工程，确认无报错，结果正常

## 8. 下一步任务

8.1 为不同 UI（例如 Overlay、菜单、技能栏等）实例化对应的 WidgetController
 8.2 搭建数据传递与广播系统，实现 UI 与数据层的交互

