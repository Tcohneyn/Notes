### OverlayWidgetController

#### 1. 引入与目标

- 从 HUD 将 Widget 添加到视口
- 需要为 Widget 提供 Widget Controller
- Widget Controller 有四个关键变量：PlayerController、PlayerState、ASC、AttributeSet

#### 2. 创建参数结构体 FWidgetControllerParams

- 作用：统一管理四个关键变量
- 设置为 BlueprintType，可在蓝图中使用
- 定义默认构造函数与带参数构造函数
- 使用成员初始化列表初始化四个变量
- 每个变量使用 `TObjectPtr`，并设置 `UPROPERTY(EditAnywhere, BlueprintReadWrite)`

#### 3. AuraWidgetController 类扩展

- 添加函数 `SetWidgetControllerParams`
  - 接收 `FWidgetControllerParams` 引用
  - 将四个关键变量赋值到成员变量
- 设置为 `BlueprintCallable`，蓝图可调用

#### 4. 创建 OverlayWidgetController 子类

- AuraWidgetController 作为基类
- 创建派生类 `OverlayWidgetController`
- 使用 HUD 来构造 OverlayWidgetController

#### 5. HUD 中的设计

- **添加 Getter**：`GetOverlayWidgetController`
  - 功能：获取 OverlayWidgetController，如果没有则创建
  - 使用 `NewObject` 创建新对象
  - 设置 WidgetControllerParams
  - 保存为 HUD 的成员变量
- **成员变量**
  - OverlayWidgetController 指针
  - OverlayWidgetControllerClass 可在蓝图设置

#### 6. InitOverlay 函数

- 新增函数 `InitOverlay` 接收四个关键变量
- 功能：统一初始化 Overlay
  1. 校验 OverlayWidgetClass 与 OverlayWidgetControllerClass（使用 `checkf`）
  2. 创建 Widget，并转换为 AuraUserWidget
  3. 创建 `FWidgetControllerParams` 结构体
  4. 调用 `GetOverlayWidgetController` 获取并初始化 WidgetController
  5. 将 WidgetController 设置给 OverlayWidget
  6. 最终将 OverlayWidget 添加到视口

#### 7. BeginPlay 移除与逻辑迁移

- 移除原先 BeginPlay 中的初始化逻辑
- 将所有逻辑迁移到 `InitOverlay`

