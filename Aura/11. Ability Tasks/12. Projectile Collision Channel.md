# 投射物的碰撞通道

------

## 一、问题说明：投射物的碰撞异常

- 投射物会错误地击中拾取物（例如药水）并触发爆炸。
- 某些物体又无法与投射物产生碰撞。
- 目标：修正投射物的碰撞逻辑，使其能正确与敌人交互、忽略拾取物。

------

## 二、基础修复：让静态物体参与碰撞

- 示例问题：火球穿过柱子。
- 解决方案：在柱体组件中启用 **Generate Overlap Events（生成重叠事件）**。

------

## 三、分析：为什么拾取物会被火球击中

- 投射物与拾取物都属于 **WorldDynamic** 类型。
- 默认情况下，Firebolt 的球体组件设置为：
  - Object Type：World Dynamic
  - Overlap：World Static / World Dynamic / Pawn
- 因此，拾取物（也是 World Dynamic）会被误判为可重叠对象。

------

## 四、创建新的碰撞对象类型 Projectile

1. 打开 **Project Settings → Collision → Object Channels**。
2. 新建 Object Channel：
   - 名称：`Projectile`
   - 默认响应：`Ignore`（忽略）
3. 理由：
   - 与拾取物区分类型；
   - 默认忽略除 WorldStatic、WorldDynamic、Pawn 以外的对象；
   - 后续手动指定哪些对象需 Overlap。

------

## 五、在 C++ 中定义 Projectile 碰撞通道宏

- 打开 `Aura.h` 文件：

  ```cpp
  #define ECC_Projectile ECollisionChannel::ECC_GameTraceChannel1
  ```

- 说明：

  - 第一个自定义通道默认为 Game Trace Channel 1；
  - 若创建更多，依次为 2、3、4 等。

- 方便在 C++ 中引用通道类型。

------

## 六、在效果体与拾取物中应用忽略规则

- 所有 AuraEffectActor（例如拾取物）的碰撞体应 **忽略 Projectile 通道**。
- 打开 `ManaPotion` 蓝图：
  - 将 Box 碰撞设为 **Custom**；
  - 确认 `Projectile` 响应设为 **Ignore**（默认即为忽略）。
- 对需要被火球检测到的对象（如柱子），手动改为 **Overlap**。

------

## 七、为投射物设置正确的 Object Type

- 打开 Firebolt 蓝图：

  - 将 Sphere 组件的 Object Type 改为 **Projectile**。

- 同时在 C++ 中强制设置：

  ```cpp
  Sphere->SetCollisionObjectType(ECC_Projectile);
  ```

- 确保定义头文件中包含 `Aura.h`。

------

## 八、验证拾取物忽略效果

- 编译并运行后，投射物穿过药水不再触发爆炸。
- 说明拾取物与 Projectile 通道正确分离。

------

## 九、让敌人能与投射物交互

- 敌人（Enemy Base）的 Mesh 应设置为 **Overlap Projectile**。

- 在 C++ 中修改：

  ```cpp
  GetMesh()->SetCollisionResponseToChannel(ECC_Projectile, ECR_Overlap);
  ```

- 结果：敌人能检测到投射物命中。

------

## 十、确保 Mesh 生成重叠事件

- 若火球仍未在敌人处爆炸 → 原因是 Mesh 未勾选 **Generate Overlap Events**。

- 在蓝图中手动启用，或在 C++ 中添加：

  ```cpp
  GetMesh()->SetGenerateOverlapEvents(true);
  ```

- 确保该设置在所有敌人和角色基类中生效。

------

## 十一、测试与结果

- 投射物可穿过拾取物（不触发爆炸）。
- 击中敌人时触发爆炸效果。
- 碰撞逻辑完全符合预期。

------

## 十二、总结与后续

- 修正了投射物与拾取物的碰撞冲突。
- 建立了独立的 Projectile 碰撞通道。
- 确保敌人与投射物能正确重叠与反应。
- 下节将继续完善技能系统逻辑。

------

