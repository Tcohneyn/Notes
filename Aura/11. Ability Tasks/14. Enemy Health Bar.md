#  Enemy Health Bar 

------

## **1️⃣ 视频整体目标**

目标：在 Unreal Engine 中为敌人创建血条（Enemy Health Bar），并实现实时更新。
 核心模块：

- **Enemy Actor**：敌人本体
- **Health Component**：管理血量
- **Widget**：显示血条 UI
- **更新逻辑**：敌人血量变化时同步更新 UI

------

## **2️⃣ 流程总结（时间线拆解）**

### **00:00 ~ 05:00 – 创建 Widget**

- 创建 `EnemyHealthBar` Widget Blueprint
- 添加 **Progress Bar** 组件作为血条
- 设置默认样式（颜色、背景）
- 绑定血条百分比属性（稍后通过 Enemy Actor 动态更新）

**可视化流程（文本版）**

```
EnemyHealthBar Widget
 ├─ ProgressBar (血条)
 └─ 绑定属性 -> Enemy 当前血量百分比
```

------

### **05:01 ~ 10:00 – 设置敌人血量组件**

- 在 Enemy Actor 上添加 `HealthComponent`
- 定义变量：
  - MaxHealth
  - CurrentHealth
- 添加事件：
  - `TakeDamage(float DamageAmount)`：扣血逻辑
  - `OnHealthChanged(float NewHealth)`：广播血量变化

**流程可视化**

```
Enemy Actor
 └─ HealthComponent
     ├─ MaxHealth
     ├─ CurrentHealth
     ├─ TakeDamage()
     └─ OnHealthChanged() -> 通知 Widget 更新
```

------

### **10:01 ~ 15:00 – Widget 与 Actor 绑定**

- 在 Enemy Actor 上实例化 Widget
- 将 Widget 附加到敌人上方（World Space）
- 创建绑定：
  - `ProgressBar.Percent` = `CurrentHealth / MaxHealth`

**流程可视化**

```
Enemy Actor
 ├─ Spawn EnemyHealthBar Widget
 ├─ Attach Widget (World Space, Head上方)
 └─ Bind ProgressBar.Percent -> CurrentHealth / MaxHealth
```

------

### **15:01 ~ 20:00 – 血量变化更新**

- 当 Enemy 受伤时：
  1. 调用 `TakeDamage()`
  2. HealthComponent 更新 CurrentHealth
  3. 广播 `OnHealthChanged`
  4. Widget 接收到事件 → 更新 ProgressBar

**流程可视化**

```
玩家攻击 Enemy
 └─ Enemy.TakeDamage()
     ├─ HealthComponent.CurrentHealth -= Damage
     └─ OnHealthChanged() -> Widget.Update(Percent)
```

------

### **20:01 ~ 25:00 – 优化显示**

- 可选动画：
  - 血条逐渐减少（Lerp / Timeline）
  - 避免瞬间闪动
- 添加消失逻辑：
  - 敌人死亡后血条隐藏或销毁

**流程可视化**

```
OnHealthChanged
 └─ ProgressBar Percent -> Lerp(CurrentPercent -> NewPercent)
Enemy死亡 -> Widget Destroy
```

------

### **25:01 ~ 30:22 – 测试与调试**

- 确认血条跟随敌人移动
- 检查血条百分比正确显示
- 调整颜色、大小、偏移，确保视觉效果良好
- 最终效果：
  - 血条显示敌人当前血量
  - 动态更新
  - 敌人死亡时消失

**最终结构图**

```
玩家攻击 -> Enemy.TakeDamage()
 └─ HealthComponent.OnHealthChanged()
     └─ EnemyHealthBar Widget.ProgressBar 更新
          └─ 血条动画（可选 Lerp）
Enemy死亡 -> Widget Destroy
```

------

✅ **总结要点**

1. 核心是 **Actor + HealthComponent + Widget + 绑定更新**
2. Widget 显示通过 **World Space** 附加在敌人头上
3. 血量变化触发事件 → 更新 ProgressBar
4. 可加动画与隐藏逻辑增强效果

------

