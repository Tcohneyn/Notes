# UE5 GAS - Primary 与 Secondary Attributes 系统设计

## 1. 引入概念

- 修饰符（Modifiers）可以基于属性来修改其他属性
- 打开了 RPG 样式属性设计的重要方向：**派生属性（Derived Attributes）**
- **派生属性**：部分或完全依赖于其他属性的属性

------

## 2. 属性分类

### 2.1 Primary Attributes（主要属性）

- 不依赖其他属性
- 可以通过游戏机制独立增加或减少
- 所有其他属性或多或少依赖于它们
- 设计中的 4 个 Primary Attributes：
  - **Strength（力量）** → 增加物理伤害
  - **Intelligence（智力）** → 增加魔法伤害
  - **Resilience（韧性）** → 增加护甲、护甲穿透
  - **Vigor（体力）** → 增加生命值

------

### 2.2 Secondary Attributes（派生属性）

- 更紧密地影响战斗与玩法
- 由 Primary 或其他 Secondary 派生
- 设计的 Secondary Attributes 列表：
  - **Armor（护甲）** → 依赖 Resilience，减少伤害、增加格挡几率
  - **Armor Penetration（护甲穿透）** → 依赖 Resilience，忽略敌方护甲并增加暴击率
  - **Block Chance（格挡几率）** → 依赖 Armor，受击时减半伤害
  - **Critical Hit Chance（暴击几率）** → 依赖 Armor Penetration，增加双倍伤害触发几率
  - **Critical Hit Damage（暴击伤害）** → 依赖 Armor Penetration，增加额外暴击伤害
  - **Critical Hit Resistance（暴击抗性）** → 依赖 Armor，降低敌人暴击几率
  - **Health Regeneration（生命回复）** → 依赖 Vigor，每秒恢复生命
  - **Mana Regeneration（法力回复）** → 依赖 Intelligence，每秒恢复法力
  - **Max Health（最大生命）** → 依赖 Vigor（重新分类为 Secondary）
  - **Max Mana（最大法力）** → 依赖 Intelligence（重新分类为 Secondary）

------

## 3. 属性实现流程

- **实现步骤**（所有 Secondary 属性都需要执行）：
  1. **声明变量**（UProperty）
  2. **添加 RepNotify 函数**（OnRep）
  3. **使用 GameplayAttributeRepNotify 宏**（通知 ASC）
  4. **注册到 GetLifetimeReplicatedProps**（支持同步）
  5. **添加 Attribute Accessors 宏**（简化访问）

------

## 4. 课程任务（Quest）

- 向 AttributeSet 中添加所有 Secondary 属性
- 可自定义或使用讲解中的列表
- 完成上述所有 boilerplate 步骤
- 保证所有属性可被正确复制与同步

------

## 5. 实操总结

- 讲解者通过 **time-lapse** 快速添加了所有 Secondary 属性
- 检查点：
  - 是否为每个属性都加了 RepNotify
  - 是否都在 .cpp 中定义了 OnRep 并使用宏
  - 是否都注册到 GetLifetimeReplicatedProps
- **MaxHealth / MaxMana 移入 Secondary 分类**
- 最终，Secondary Attributes 已实现复制并随 Primary 变化而更新
- 下一步：让 Secondary 自动随其依赖属性变化而更新

