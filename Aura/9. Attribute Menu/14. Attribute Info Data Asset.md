# 1. 创建 Attribute Info 数据资产与结构体

## 1.1 完成前置步骤

- 已经在 C++ 中创建了 **Secondary Attribute Gameplay Tags**。
- 接下来要创建用于存储属性信息的数据资产。

------

# 2. 新建 Attribute Info 数据资产类

## 2.1 在编辑器中创建 C++ 类

- 在 `C++ Classes → Aura → Public → AbilitySystem → Data` 下创建新的 `DataAsset` 类。
- 命名为 `AttributeInfo`。

## 2.2 Data Asset 的用途

- 允许以蓝图可编辑的形式存储结构化属性信息（如名称、描述等）。
- 可供 UI Widget 使用，展示动态属性数据。

------

# 3. 创建 F Aura Attribute Info 结构体

## 3.1 定义结构体

- 新建 `FAuraAttributeInfo`。
- 使用 `USTRUCT(BlueprintType)` 以便蓝图访问。
- 添加 `GENERATED_BODY()` 宏。

## 3.2 成员变量定义

1. **AttributeTag**：`FGameplayTag`
   - 用于标识具体的属性类型（如 Intelligence、Strength）。
   - 需要 `GameplayTagContainer.h` 头文件。
   - `UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)`，可蓝图内编辑。
2. **AttributeName**：`FText`
   - 显示在 UI 上的属性名称。
   - 用户可编辑，`EditDefaultsOnly, BlueprintReadOnly`。
3. **AttributeDescription**：`FText`
   - 属性的说明文字（如“增加魔法伤害”）。
   - 同样使用 FText，蓝图可编辑。
4. **AttributeValue**：`float`
   - 实际属性数值，初始化为 0。
   - 不在 DataAsset 中设置，只在运行时赋值。
   - `BlueprintReadOnly`，不可在编辑器修改。

------

# 4. 将结构体应用到 Data Asset

## 4.1 添加数组

- 在 `UAttributeInfo` 类中创建：

  ```cpp
  TArray<FAuraAttributeInfo> AttributeInformation;
  ```

- 用于存放所有属性的结构体信息。

- 设置为 `EditDefaultsOnly, BlueprintReadOnly`，在蓝图中编辑。

------

# 5. 查找属性信息函数

## 5.1 定义查找函数

```cpp
FAuraAttributeInfo FindAttributeInfoForTag(
    const FGameplayTag& AttributeTag,
    bool bLogNotFound = false
) const;
```

- 输入：`FGameplayTag`
- 输出：对应的 `FAuraAttributeInfo`
- 若找不到且 `bLogNotFound = true`，则输出错误日志。

## 5.2 实现逻辑

- 使用 `for(const FAuraAttributeInfo& Info : AttributeInformation)` 遍历数组。

- 判断：

  ```cpp
  if (Info.AttributeTag == AttributeTag)
      return Info;
  ```

  或使用 `MatchesTagExact()`。

- 若遍历完仍未找到：

  - 使用 `UE_LOG(LogTemp, Error, TEXT("Can't find info for tag: %s"), *AttributeTag.ToString());`
  - 返回空结构体。

------

# 6. 在编辑器中创建蓝图数据资产

## 6.1 创建实例

- 在编辑器中右键 → **Miscellaneous → Data Asset**。
- 选择 `AttributeInfo` 类 → 命名为 `DA_AttributeInfo`。

## 6.2 填充属性信息

- 在 `AttributeInformation` 数组中添加多个元素：
  - `AttributeTag`：从 GameplayTags 下拉选择（如 Primary.Intelligence）。
  - `AttributeName`：填写“Intelligence”。
  - `AttributeDescription`：可从 C++ 中的注释复制，如“增加魔法伤害”。

## 6.3 属性值处理

- `AttributeValue` 不可在面板设置（BlueprintReadOnly），将在运行时动态赋值。

------

# 7. 数据结构完善与扩展

- 可在将来为 `FAuraAttributeInfo` 添加更多字段（如图标、颜色、成长率等）。
- 若属性过多，可拆分为多个数组，但目前保留单一列表。

------

# 8. 整体逻辑回顾

1. 创建并初始化 `DataAsset` 类。
2. 定义 `FAuraAttributeInfo` 结构体，用于存储属性数据。
3. 在 `UAttributeInfo` 中定义数组保存所有属性信息。
4. 实现查找函数，通过 `GameplayTag` 获取对应信息。
5. 在蓝图中创建数据资产实例并填充。

------

# 9. 下一步计划

- 接下来将创建 **Attribute Menu Widget Controller**。
- 用以驱动 UI，动态显示 DataAsset 中的属性值与描述。

