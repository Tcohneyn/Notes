# ğŸ¯ Attribute Menu Widget Controller â€” å±æ€§èœå•æ§åˆ¶å™¨å®Œæ•´é€»è¾‘ï¼ˆ00:00:00,240 ï½ 00:16:01,890ï¼‰

------

## ä¸€ã€åŠŸèƒ½ç›®æ ‡

- å®ç°è§’è‰²å±æ€§èœå•ï¼ˆAttribute Menuï¼‰ç•Œé¢ï¼š
  - é€šè¿‡ **C++ ä¸è“å›¾ç»“åˆ**ï¼ŒåŠ¨æ€è¯»å–è§’è‰²å±æ€§å€¼ã€‚
  - å°†å±æ€§ä¿¡æ¯å¹¿æ’­ç»™ UI Widgetï¼Œæ˜¾ç¤ºåœ¨å„è¡Œæ–‡æœ¬ç»„ä»¶ä¸Šã€‚
- æ ¸å¿ƒæµç¨‹ï¼š
  - **ç»‘å®šä¾èµ– â†’ å¹¿æ’­åˆå§‹å€¼ â†’ å»ºç«‹å§”æ‰˜ â†’ æŒ‰æ ‡ç­¾æ›´æ–°æ˜¾ç¤ºã€‚**

------

## äºŒã€åŸºç¡€ç»“æ„ä¸æ•°æ®å‡†å¤‡

### 1. å…³è”çš„ç±»ä¸æ•°æ®

- **UAuraAttributeSet**
  - å­˜å‚¨è§’è‰²åŸºç¡€ä¸æ¬¡çº§å±æ€§ï¼ˆåŠ›é‡ã€æ™ºåŠ›ã€é˜²å¾¡ç­‰ï¼‰ã€‚
- **UAttributeInfoï¼ˆData Assetï¼‰**
  - æŒ‰ GameplayTag å­˜å‚¨æ¯ä¸ªå±æ€§çš„åç§°ã€æè¿°ã€å›¾æ ‡ç­‰ã€‚
- **FAuraGameplayTags**
  - ç»Ÿä¸€å®šä¹‰æ‰€æœ‰å±æ€§æ ‡ç­¾ï¼ˆPrimary / Secondary / Vitalï¼‰ã€‚

------

## ä¸‰ã€åˆå§‹åŒ–ä¸å¹¿æ’­åˆå§‹å±æ€§å€¼

### 1. ç»‘å®šä¾èµ–æ¥å£

```cpp
void UAttributeMenuWidgetController::BindCallbacksToDependencies()
{
    // åç»­å°†ç»‘å®šå±æ€§å˜åŒ–å›è°ƒï¼Œç›®å‰ç•™ç©ºã€‚
}
```

### 2. å¹¿æ’­åˆå§‹å€¼é€»è¾‘

```cpp
void UAttributeMenuWidgetController::BroadcastInitialValues()
{
    UAuraAttributeSet* AS = CastChecked<UAuraAttributeSet>(AttributeSet);
    check(AttributeInfo);

    FAuraAttributeInfo Info = AttributeInfo->FindAttributeInfoForTag(
        FAuraGameplayTags::Get().Attributes_Primary_Strength
    );
    Info.AttributeValue = AS->GetStrength();
    AttributeInfoDelegate.Broadcast(Info);
}
```

#### è¯´æ˜ï¼š

- ä» AttributeSet è¯»å–å½“å‰å±æ€§å€¼ã€‚
- åœ¨ Data Asset ä¸­æŸ¥æ‰¾å¯¹åº”å±æ€§ä¿¡æ¯ã€‚
- æ›´æ–°ç»“æ„ä½“å¹¶å¹¿æ’­å§”æ‰˜ã€‚
- Widget ç«¯æ¥æ”¶åæ˜¾ç¤ºåœ¨ UI ä¸Šã€‚

------

## å››ã€Blueprint ä¸­çš„å§”æ‰˜ç»‘å®š

### 1. åœ¨è“å›¾ Widget Controller è®¾ç½®

- åœ¨è“å›¾ç±»ä¸­ç»‘å®š `AttributeInfo` æ•°æ®èµ„äº§å¼•ç”¨ã€‚
- åœ¨ `Event Construct` ä¸­è°ƒç”¨ `BroadcastInitialValues`ã€‚
- ç¡®ä¿å¹¿æ’­æ—¶æ•°æ®èµ„äº§å·²å‡†å¤‡å®Œæ¯•ã€‚

### 2. åœ¨ Widget ç«¯ç»‘å®šå§”æ‰˜

- åœ¨ UI Widgetï¼ˆå¦‚ TextValueButtonRowï¼‰ä¸­ï¼š
  - è·å– `AttributeMenuWidgetController`ã€‚
  - ç»‘å®š `AttributeInfoDelegate`ã€‚
  - ä½¿ç”¨ **Break Struct** è·å–å±æ€§åä¸æ•°å€¼ã€‚
  - è°ƒç”¨ `SetLabelText()` ä¸ `SetValueText()` æ›´æ–°ç•Œé¢ã€‚

------

## äº”ã€çˆ¶ç±»ç»„ä»¶å°è£…ï¼ˆTextValueRowï¼‰

### 1. æå–å…¬å…±é€»è¾‘

- çˆ¶ç±» `TextValueRow` è´Ÿè´£ï¼š

  - åŸºç¡€æ–‡æœ¬æ§ä»¶ï¼ˆLabel / Valueï¼‰ã€‚

  - è®¾ç½®æ–‡æœ¬çš„å‡½æ•°ï¼š

    ```cpp
    void SetLabelText(FText LabelText);
    void SetValueText(FText ValueText);
    ```

- å­ç±» `TextValueButtonRow`ï¼š

  - åœ¨å§”æ‰˜è§¦å‘æ—¶è°ƒç”¨çˆ¶ç±»æ¥å£æ›´æ–°å†…å®¹ã€‚

------

## å…­ã€ä¸ºå±æ€§èœå•è®¾ç½® Gameplay Tag åŒºåˆ†

### 1. åœ¨æ¯è¡Œç»„ä»¶ä¸­æ·»åŠ å˜é‡

- æ‰“å¼€ **TextValueRow** è“å›¾ï¼š
  - æ–°å¢å˜é‡ï¼š`AttributeTag`
  - ç±»å‹ï¼šGameplay Tag
  - å‹¾é€‰ **Instance Editable / Expose on Spawn**
  - ç”¨äºæ ‡è¯†è¯¥è¡Œå¯¹åº”çš„å±æ€§ã€‚

### 2. åœ¨ä¸» Attribute Menu ä¸­å‘½åæ‰€æœ‰è¡Œ

- é‡å‘½åæ¯è¡Œæ§ä»¶ï¼ˆå¹¶å‹¾é€‰ Is Variableï¼‰ï¼š

  ```
  Row_Strength
  Row_Intelligence
  Row_Resilience
  Row_Vigor
  Row_Armor
  Row_ArmorPenetration
  Row_BlockChance
  Row_CriticalHitChance
  Row_CriticalHitDamage
  Row_CriticalHitResistance
  Row_HealthRegeneration
  Row_ManaRegeneration
  Row_MaxHealth
  Row_MaxMana
  ```

------

## ä¸ƒã€åœ¨è“å›¾ä¸­è®¾ç½® Attribute Tag åˆå§‹åŒ–

### 1. æ–°å»ºå‡½æ•° `SetAttributeTags`

- åœ¨ä¸» Widget è“å›¾ä¸­æ·»åŠ å‡½æ•°ï¼š

  - ä¾æ¬¡è®¾ç½®æ¯ä¸ª Row çš„ AttributeTagï¼š

    ```text
    Row_Strength â†’ Attributes.Primary.Strength
    Row_Intelligence â†’ Attributes.Primary.Intelligence
    Row_Resilience â†’ Attributes.Primary.Resilience
    Row_Vigor â†’ Attributes.Primary.Vigor
    ...
    ```

- ç”¨ **Sequence Node** åˆ†ç»„æ‰§è¡Œä¸»å±æ€§ / æ¬¡å±æ€§ã€‚

- åœ¨ä¸» Event Graph ä¸­æ‰§è¡Œé¡ºåºï¼š

  ```
  Sequence:
  â”œâ”€ Then 0ï¼šç»‘å®šå…³é—­æŒ‰é’®
  â”œâ”€ Then 1ï¼šè®¾ç½® WidgetController
  â”œâ”€ Then 2ï¼šSetAttributeTagsï¼ˆæ–°å»ºå‡½æ•°ï¼‰
  â””â”€ Then 3ï¼šBroadcastInitialValuesï¼ˆè°ƒç”¨ï¼‰
  ```

------

## å…«ã€åŸºäº Tag çš„å±æ€§åŒ¹é…ä¸æ›´æ–°é€»è¾‘

### 1. åœ¨ TextValueButtonRow ä¸­å®ç°åŒ¹é…

- å½“å§”æ‰˜å¹¿æ’­ `FAuraAttributeInfo`ï¼š

  - ä½¿ç”¨ `MatchesTag(ExactMatch)` æ£€æŸ¥æ˜¯å¦æ˜¯æœ¬è¡Œå¯¹åº”å±æ€§ã€‚

  - åŒ¹é…æˆåŠŸæ‰æ›´æ–°æ˜¾ç¤ºï¼š

    ```
    SetLabelText(Info.AttributeName)
    SetValueText(Info.AttributeValue)
    ```

- æµ‹è¯•ç»“æœï¼š
   ä»…åŠ›é‡ï¼ˆStrengthï¼‰è¡Œæ›´æ–°ï¼Œé€»è¾‘æ­£ç¡®ã€‚

------

## ä¹ã€å°†ç»‘å®šé€»è¾‘ä¸Šç§»è‡³çˆ¶ç±»

- å°†åŸæœ¬åœ¨ `TextValueButtonRow` çš„ç»‘å®šé€»è¾‘ç§»è‡³çˆ¶ç±» `TextValueRow`ï¼š
  - åœ¨ `Event Construct` ä¸­ç»‘å®šå§”æ‰˜ã€‚
  - æ‰€æœ‰ç»§æ‰¿è‡ªå®ƒçš„è¡Œï¼ˆåŒ…æ‹¬æ— æŒ‰é’®çš„æ¬¡å±æ€§è¡Œï¼‰éƒ½èƒ½å“åº”æ›´æ–°ã€‚
- ä¼˜åŒ–åï¼š
  - å„è¡Œè‡ªåŠ¨è¯†åˆ«è‡ªèº« Tag å¹¶æ›´æ–°æ˜¾ç¤ºã€‚

------

## ğŸ”š åã€å½“å‰å®ç°æ€»ç»“

| åŠŸèƒ½                            | å®ç°çŠ¶æ€ |
| ------------------------------- | -------- |
| ç»‘å®š AttributeSet ä¸ Data Asset | âœ…        |
| å¹¿æ’­åˆå§‹å±æ€§ä¿¡æ¯                | âœ…        |
| Delegate æœºåˆ¶å»ºç«‹               | âœ…        |
| æ¯è¡Œ Widget ç‹¬ç«‹åŒ¹é…å±æ€§        | âœ…        |
| è“å›¾æ‰¹é‡è®¾ç½® AttributeTag       | âœ…        |
| çˆ¶ç±»å°è£…ç»Ÿä¸€æ›´æ–°é€»è¾‘            | âœ…        |

------

## ğŸ§© ä¸‹èŠ‚é¢„å‘Š

- æ‰©å±•ï¼š**å¹¿æ’­æ‰€æœ‰å±æ€§å€¼ï¼ˆæ‰¹é‡å¹¿æ’­ Primary / Secondary / Vitalï¼‰**
- å®ç°ï¼š**å±æ€§å˜åŒ–æ—¶å®æ—¶æ›´æ–° UIã€‚**

