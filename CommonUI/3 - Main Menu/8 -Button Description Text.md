## âš™ï¸ èœå•ä¼˜åŒ–ä¸æŒ‰é’®æè¿°æ–‡æœ¬å¹¿æ’­è®¾ç½®

æœ¬èŠ‚è¯¾è¿›è¡Œäº†ä¸¤é¡¹ä¸»è¦å·¥ä½œï¼šè°ƒæ•´é»˜è®¤æ–‡æœ¬æ ·å¼ä»¥ä¼˜åŒ–è§†è§‰æ•ˆæœï¼Œä»¥åŠè®¾ç½®é€»è¾‘æ¥åœ¨é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºæŒ‰é’®çš„æè¿°æ–‡æœ¬ã€‚

------

### 1. ğŸ¨ æ ·å¼è°ƒæ•´ä¸èµ„äº§é‡å‘½å

#### 1.1. é»˜è®¤æ–‡æœ¬é¢œè‰²è°ƒæ•´

- **ç›®æ ‡ï¼š** é™ä½é»˜è®¤æ–‡æœ¬é¢œè‰²çš„äº®åº¦ï¼Œä½¿å…¶æ›´æŸ”å’Œã€‚
- **æ“ä½œï¼š**
  1. æ‰“å¼€ **`Text_Default`** æ–‡æœ¬æ ·å¼èµ„äº§ã€‚
  2. è°ƒæ•´ **Color** å±æ€§çš„é¢œè‰²å€¼ï¼ˆAlphaä¿æŒä¸å˜ï¼‰ã€‚
  3. å°†äº®åº¦å€¼ä» $0.5$ **é™ä½åˆ° $0.3$**ã€‚
  4. ç¼–è¯‘å¹¶ä¿å­˜ï¼ŒéªŒè¯è§†è§‰æ•ˆæœã€‚

#### 1.2. æŒ‰é’®æ ·å¼èµ„äº§é‡å‘½åä¸åˆ†ç¦»

ä¸ºäº†åŒºåˆ†ä¸åŒæŒ‰é’®ç±»å‹ï¼Œå¯¹æŒ‰é’®æ ·å¼èµ„äº§è¿›è¡Œäº†é‡å‘½åå’Œå¤åˆ¶ã€‚

- **é‡å‘½åï¼š** å°†å½“å‰ä½¿ç”¨çš„æŒ‰é’®æ ·å¼ **`Button_Frontend_Clear`** é‡å‘½åä¸º **`Button_Frontend_Clear_Menu`**ã€‚
  - **åŸå› ï¼š** è¿™ä¸ªæ ·å¼åŒ…å«æ‰€æœ‰ä¸º**èœå•æŒ‰é’®**è®¾ç½®çš„æ–‡æœ¬æ ·å¼ï¼ˆé«˜äº®/é»˜è®¤ï¼‰ï¼Œåç¼€ `_Menu` ç”¨äºæ˜ç¡®ç”¨é€”ã€‚
- **å¤åˆ¶å¹¶æ¸…é™¤æ–‡æœ¬æ ·å¼ï¼š** å¤åˆ¶ `Button_Frontend_Clear_Menu` èµ„äº§ã€‚
  - é‡å‘½åä¸º **`Button_Frontend_Clear`**ï¼ˆä¸å¸¦ `_Menu` åç¼€ï¼‰ã€‚
  - åŒå‡»æ‰“å¼€æ–°çš„ **`Button_Frontend_Clear`**ï¼Œå¹¶**æ¸…é™¤**æ‰€æœ‰ **TextStyle** èµ„äº§ï¼ˆä½¿å…¶ä¸åŒ…å«ä»»ä½•æ–‡æœ¬æ ·å¼å¼•ç”¨ï¼‰ã€‚
  - **åŸå› ï¼š** è¿™ä¸ªæ ·å¼å°†ç”¨äºæœªæ¥ä¸éœ€è¦æ”¹å˜æ–‡æœ¬å¤–è§‚çš„æŒ‰é’®ã€‚

#### 1.3. C++ ä»£ç å®‰å…¨æ£€æŸ¥

ä¸ºé˜²æ­¢åœ¨æ²¡æœ‰è®¾ç½®æ–‡æœ¬æ ·å¼çš„æŒ‰é’®ä¸Šå°è¯•åº”ç”¨ç©ºæ ·å¼å¯¼è‡´å´©æºƒï¼Œå¢åŠ äº†å®‰å…¨æ£€æŸ¥ã€‚

- **æ–‡ä»¶ï¼š** `CommandButton.cpp`

- **å‡½æ•°ï¼š** é‡å†™çš„ `NativeOnCurrentTextStyleChanged()`

- **ä¿®æ”¹ï¼š** åœ¨ `if (CommonTextBlock_ButtonText)` æ£€æŸ¥ä¸­ï¼Œå¢åŠ ä¸€ä¸ªæ¡ä»¶ï¼Œç¡®ä¿ä» `GetStyle()` è·å–åˆ°çš„ **TextStyle Class** æ˜¯æœ‰æ•ˆçš„ã€‚

  C++

  ```
  // ä¼ªä»£ç ï¼šç¡®ä¿è·å–åˆ°çš„æ ·å¼ç±»æ˜¯æœ‰æ•ˆçš„
  if (CommonTextBlock_ButtonText && GetStyle()->GetTextStyleClass())
  {
      // ... SetStyle é€»è¾‘ ...
  }
  ```

------

### 2. ğŸ“ æŒ‰é’®æè¿°æ–‡æœ¬å¹¿æ’­æœºåˆ¶è®¾ç½®

ç›®æ ‡æ˜¯å½“é¼ æ ‡æ‚¬åœåœ¨èœå•æŒ‰é’®ä¸Šæ—¶ï¼Œå°†æŒ‰é’®çš„æè¿°æ–‡æœ¬å¹¿æ’­å‡ºå»ï¼Œä¾›åº•éƒ¨æè¿°æ–‡æœ¬ Widget æ¥æ”¶å’Œæ˜¾ç¤ºã€‚

#### 2.1. åœ¨ UI Subsystem ä¸­å®šä¹‰ Delegate

éœ€è¦åœ¨ `UFrontendUISubsystem` ä¸­åˆ›å»ºå§”æ‰˜ï¼ˆDelegateï¼‰æ¥å®ç°å¹¿æ’­ã€‚

- **æ–‡ä»¶ï¼š** `FrontendUISubsystem.h`

- **å®šä¹‰å§”æ‰˜ï¼š** å£°æ˜ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå‚æ•°çš„åŠ¨æ€å¤šæ’­å§”æ‰˜ã€‚

  C++

  ```
  DECLARE_DYNAMIC_MULTICAST_DELEGATE_TwoParams(
      FOnButtonDescriptionTextUpdatedDelegate,
      UCommonButtonBase*, // ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹ï¼ˆéœ€è¦å‰ç½®å£°æ˜ UCommonButtonBaseï¼‰
      BroadcastingButton, // æŒ‰é’®æœ¬èº«
      FText,              // ç¬¬äºŒä¸ªå‚æ•°ç±»å‹
      DescriptionText     // æè¿°æ–‡æœ¬å†…å®¹
  );
  ```

- **å£°æ˜å§”æ‰˜å˜é‡ï¼š** åœ¨ `public` éƒ¨åˆ†å£°æ˜è¯¥å§”æ‰˜çš„å®ä¾‹å˜é‡ã€‚

  C++

  ```
  UPROPERTY(BlueprintAssignable)
  FOnButtonDescriptionTextUpdatedDelegate OnButtonDescriptionTextUpdated;
  ```

  - å¿…é¡»æ ‡è®°ä¸º **`BlueprintAssignable`**ï¼Œä»¥ä¾¿åœ¨ Blueprint ä¸­ç»‘å®šå’Œè®¢é˜…ã€‚

- **ç¼–è¯‘ C++ã€‚**

#### 2.2. åœ¨ `UCommandButton` ä¸­é‡å†™ Hover å‡½æ•°å¹¶å¹¿æ’­

éœ€è¦åœ¨è‡ªå®šä¹‰æŒ‰é’®ç±» `UCommandButton` ä¸­é‡å†™æ‚¬åœç›¸å…³çš„è™šå‡½æ•°ï¼Œå¹¶ä½¿ç”¨ `UI Subsystem` å¹¿æ’­å§”æ‰˜ã€‚

- **æ–‡ä»¶ï¼š** `CommandButton.h`
- **é‡å†™å‡½æ•°ï¼š** åœ¨ `private` éƒ¨åˆ†å£°æ˜é‡å†™ä»¥ä¸‹ä¸¤ä¸ªè™šå‡½æ•°ï¼š
  - `virtual void NativeOnHovered() override;`
  - `virtual void NativeOnUnhovered() override;`
- **æ–‡ä»¶ï¼š** `CommandButton.cpp`
- **å®ç° `NativeOnHovered()` (é¼ æ ‡æ‚¬åœ)ï¼š**
  1. è°ƒç”¨ `Super::NativeOnHovered()`ã€‚
  2. **æ£€æŸ¥æè¿°æ–‡æœ¬æ˜¯å¦éç©º**ï¼š`if (!ButtonDescriptionText.IsEmpty())`ã€‚
  3. è·å– **`UFrontendUISubsystem`** å®ä¾‹ã€‚
  4. è°ƒç”¨ **`OnButtonDescriptionTextUpdated.Broadcast(this, ButtonDescriptionText)`**ï¼Œå¹¿æ’­æŒ‰é’®æœ¬èº«å’Œå®ƒçš„æè¿°æ–‡æœ¬ã€‚
- **å®ç° `NativeOnUnhovered()` (é¼ æ ‡å–æ¶ˆæ‚¬åœ)ï¼š**
  1. è°ƒç”¨ `Super::NativeOnUnhovered()`ã€‚
  2. è·å– **`UFrontendUISubsystem`** å®ä¾‹ã€‚
  3. è°ƒç”¨ **`OnButtonDescriptionTextUpdated.Broadcast(this, FText::GetEmpty())`**ï¼Œå¹¿æ’­ä¸€ä¸ª**ç©º FText** æ¥æ¸…é™¤æè¿°æ–‡æœ¬æ˜¾ç¤ºã€‚
- **ç¼–è¯‘ C++ã€‚**

------

### 3. ğŸš§ åç»­æ­¥éª¤

- **å½“å‰çŠ¶æ€ï¼š** å¹¿æ’­æœºåˆ¶å·²è®¾ç½®å®Œæ¯•ã€‚
- **ä¸‹ä¸€è¯¾ç›®æ ‡ï¼š**
  1. åˆ›å»ºä¸€ä¸ªæ–°çš„ Widget Blueprintï¼š`WBP_Text_Description`ã€‚
  2. è®©è¿™ä¸ª Widget Blueprint **è®¢é˜…**ï¼ˆListen toï¼‰UI Subsystem ä¸­çš„ `OnButtonDescriptionTextUpdated` å§”æ‰˜ã€‚
  3. æ ¹æ®æ¥æ”¶åˆ°çš„æ–‡æœ¬æ›´æ–°è‡ªå·±çš„æ˜¾ç¤ºå†…å®¹ã€‚